<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ajax请求测试</title>
    <!-- <script src="../../tools/util.js"></script> -->
</head>
<body>
    <button id="myget" type="button">get</button>
    <button id="mypost" type="button">post</button>
    <button id="myput" type="button">put</button>
    <button id="mypatch" type="button">patch</button>
    <button id="mydelete" type="button">delete</button>


    <script type="module">
      import {ajax  } from "../../tools/util.js";
    // 1  处理get请求
       myget.onclick = function () {

        //    console.log('绑定成功');
         //  var xhr = new XMLHttpRequest();
         //  xhr.open("GET","http://localhost:3000/users");

         //  xhr.onload = function(){
         //     if(/^2\d{2}$/.test(xhr.status)){
         //          console.log(xhr.responseText); 
         //     } 
         //  }
         //  xhr.send(); 
      // 调用封装的AJAX方法处理get请求 
         ajax({
            url:"http://localhost:3000/users" ,
            success: function(res){ 
                 console.log(res);
            }
         })


       }

    // 2 处理POST请求

      mypost.onclick = function(){
      //   var xhr = new XMLHttpRequest()
      //   xhr.open("post","http://localhost:3000/users") ;

      //   xhr.onload = function(){
      //        console.log(xhr.status);
      //        if(/^2\d{2}$/.test(xhr.status)){
      //             console.log(xhr.responseText); 
      //        } 
      //     }       
      //   xhr.setRequestHeader("content-type","application/json") ;  
      //   xhr.send(JSON.stringify({
      //         name:"kk",
      //         password:"456"
      //      })) ;
        console.log("post----执行了");   
      ajax({
            url:"http://localhost:3000/users" ,
            method:"post",
            data:{
               name: "kk",
               password: "456"
            },
            success: function(res){ 
                 console.log(res);
            },
            error:function(err){
               console.log(err);
            }
         })

      }     
      
    //   3 处理put请求,PUT是全部更新
      myput.onclick = function(){

         var xhr = new XMLHttpRequest();
         xhr.open("PUT","http://localhost:3000/users/3");

         xhr.onload = function(){
            if(/^2\d{2}$/.test(xhr.status)){
               console.log(xhr.responseText);             
           }
         }  

        xhr.setRequestHeader("content-type","application/json") ;  
        xhr.send(JSON.stringify({
              name:"zaoliu",
              password:"3456"
           })) ;

      } 

     //   4 处理patch请求,patch是部分更新   
      
     mypatch.onclick = function(){

        var xhr = new XMLHttpRequest();
         xhr.open("PATCH","http://localhost:3000/users/3");

         xhr.onload = function(){
            if(/^2\d{2}$/.test(xhr.status)){
               console.log(xhr.responseText);             
           }
         }  

        xhr.setRequestHeader("content-type","application/json") ;  
        xhr.send(JSON.stringify({
              name:"zaoliu",
              password:"789"
           })) ;       

     }
     
    // 5 处理delete请求,删除数据
    
     mydelete.onclick = function(){
        
        var xhr = new XMLHttpRequest();
          xhr.open("DELETE","http://localhost:3000/users/6");

          xhr.onload = function(){
             if(/^2\d{2}$/.test(xhr.status)){
                  console.log(xhr.responseText); 
             } 
          }
          xhr.send(); 


     }  

   </script>


</body>
</html>